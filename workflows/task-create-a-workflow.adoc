---
permalink: workflows/task-create-a-workflow.html 
sidebar: sidebar 
keywords: use, workflow, automation, create, tasks, provisioning, migrate, decommissioning, storage, databases, file, systems, predefined, wfa, match, requirements 
summary: Workflow Automation （ WFA ）を使用して、データベースやファイルシステムのストレージのプロビジョニング、移行、運用停止などのタスクのワークフローを作成できます。定義済みの WFA ワークフローが要件に合わない場合は、ワークフローを作成する必要があります。 
---
= ワークフローを作成します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Workflow Automation （ WFA ）を使用して、データベースやファイルシステムのストレージのプロビジョニング、移行、運用停止などのタスクのワークフローを作成できます。定義済みの WFA ワークフローが要件に合わない場合は、ワークフローを作成する必要があります。

.必要なもの
* WFA のビルディングブロックの概念を理解しておく必要があります。
* ワークフローに必要な繰り返し行、承認ポイント、リソース選択などの機能を理解しておく必要があります。
* ワークフロー要件チェックリストなど、ワークフローに必要な計画を完了しておく必要があります。
* ワークフローに関する情報をストレージオペレータに提供するヘルプコンテンツを作成しておく必要があります。


各ワークフローの構築は、ワークフローの目標と要件によって異なる場合があります。このタスクでは、特定のワークフローの手順については説明しませんが、ワークフローの作成に関する一般的な手順について説明します。

.手順
. [* ワークフローデザイン *>* ワークフロー *] をクリックします。
. をクリックします image:../media/new_wfa_icon.gif["新しいアイコン"] をクリックします。
. [* ワークフロー *] タブで、次の手順を実行します。
+
.. 必要なスキーマを展開し、目的のスキーマをダブルクリックします image:../media/wfa_command_icon.gif["コマンドアイコンをクリックします"] （コマンド）または image:../media/wfa_workflow_icon.gif["ワークフローアイコン"] （ワークフロー）を [ 使用可能なステップ（ Available steps ） ] リストから選択します。
+
この手順は必要に応じて繰り返すことができます。ワークフローエディタでステップをドラッグアンドドロップすると、ステップを並べ替えることができます。

.. * オプション： * クリック image:../media/add_row2_wfa_icon.gif[""] 必要な行数を追加します。これは、ステップの実行の詳細を指定するために使用されます。
+
各ステップは、指定された行と列で指定されたステップの詳細に基づいて実行されます。ステップは左から右、上から下の順に実行されます。

.. 追加したステップの下にカーソルを置き、をクリックします image:../media/add_object_wfa_icon.gif["コマンドの詳細アイコン"] ステップ実行のステップの詳細を必要な行に追加します。
+
[cols="2*"]
|===
| 手順 | 手順 


 a| 
ワークフロー
 a| 
[ * ワークフロー * （ * Workflow * ） ] タブで必要なユーザー入力を入力し、 [ * 詳細設定 * （ * Advanced * ） ] タブで必要な条件を入力します。



 a| 
コマンドを実行します
 a| 
[< コマンド > のパラメータ ] タブで、各オブジェクトタブをクリックし、必要なオプションを選択してオブジェクト属性を定義し、 [ 詳細設定 ] タブと [ その他のパラメータ ] タブに必要な詳細を入力します。



 a| 
検索または定義
 a| 
検索または定義するディクショナリエントリオブジェクトを選択します。

|===
+
次の図に、オブジェクト属性を定義するための使用可能なオプションを示します。

+
image::../media/define_object_options.gif[オブジェクトオプションを定義します]

+
適切なアクションを選択します。

+
[cols="2*"]
|===
| 用途 | 手順 


 a| 
属性を入力します
 a| 
次のオプションを使用して、属性の値を入力します。

*** 式
*** 変数（ variables ）
*** ユーザ入力
*** リソースの選択
*** 名前の増分


属性フィールドにカーソルを合わせ、をクリックする必要があります image:../media/elipsisicon.gif[""] リソース選択機能または増分命名機能を使用するには、次の手順を実行します。



 a| 
以前に定義した「 _object_ 」を使用します
 a| 
オプションリストの前のボックスで ' 以前に定義したオブジェクトを選択します



 a| 
既存の「 _object_ 」を検索します
 a| 
... [ * 検索条件を入力してください * ] をクリックし、リソース選択機能を使用してオブジェクトを検索します。
... 必要なオブジェクトが見つからない場合は、実行に必要なオプションのいずれかを選択します。
+
**** ワークフローを中止する
+
特定のオブジェクトが見つからない場合は、ワークフローの実行を中止します。

**** このコマンドを無効にします
+
 This option disables only the current step and executes the workflow.
**** 「 object 」の属性を入力し、コマンドを実行します
+
 This option enables you to enter the required attributes and execute the workflow.




|===


. 承認ポイントを挿入する場合は、をクリックします image:../media/approval_point_hover_icon.gif["承認ポイントのマウスオーバーアイコン"] をクリックし、承認ポイントに必要なコメントを入力します。
+
承認ポイントのコメントには、 MVEL 式を含めることができます。

. をクリックします image:../media/repeat_row_arrow.gif[""] 行番号の横に表示され、次の処理を実行できます。
+
** 行を挿入します。
** 行をコピーします。
** 行を繰り返します。
+
次のいずれかのオプションを使用して、コマンドパラメータの繰り返しを指定できます。

+
*** 回数
+
このオプションを使用すると、指定した繰り返し回数に対してコマンドを繰り返し実行できます。たとえば、「 Create Qtree 」コマンドを 3 回繰り返して、 3 つの qtree を作成するように指定できます。

+
このオプションは、コマンドの実行数を動的に指定する場合にも使用できます。たとえば、作成する LUN 数に対するユーザ入力変数を作成し、ワークフローの実行時またはスケジュール時にストレージオペレータが指定した数を使用できます。

*** グループ内のすべてのリソース
+
このオプションを使用して、オブジェクトの検索条件を指定できます。コマンドは、検索条件からオブジェクトが返される回数だけ繰り返し実行されます。たとえば ' クラスタ内のノードを検索し ' 各ノードに対して Create iSCSI Logical Interface コマンドを繰り返します



** 行を実行するための条件を追加します。
** 行を削除します。


. [*Details*] タブで、次の手順を実行します。
+
.. [ ワークフロー名 *] フィールドと [ ワークフロー概要 *] フィールドに必要な情報を指定します。
+
ワークフロー名と概要 は、ワークフローごとに一意である必要があります。

.. * オプション： * エンティティバージョンを指定します。
.. * オプション：予約機能を使用しない場合は、 * 予約済みエレメントを考慮 * チェックボックスをオフにします。
.. * オプション： * 同じ名前のエレメントの検証を有効にしない場合は、 * エレメントの存在検証を有効にする * チェックボックスをオフにします。


. ユーザ入力を編集する場合は、次の手順を実行します。
+
.. [ ユーザー入力 * （ User Inputs * ） ] タブをクリックします。
.. 編集するユーザ入力をダブルクリックします。
.. [ 変数の編集： < ユーザー入力 >*] ダイアログボックスで、ユーザー入力を編集します。


. 定数を追加する場合は、次の手順を実行します
+
.. [ 定数 *] タブをクリックし、 [ *Add* ] ボタンを使用してワークフローに必要な定数を追加します。
+
複数のコマンドのパラメーターを定義するために共通の値を使用している場合は、定数を定義できます。たとえば 'Create 'LUN with SnapVault ワークフローで使用される aggregate_OLIDE_THRESHOLD 定数を参照してください

.. 各定数の名前、概要 、および値を入力します。


. [ * 戻りパラメータ * ] タブをクリックし、 [ * 追加 ] ボタンを使用してワークフローに必要なパラメータを追加します。
+
ワークフローの計画と実行で、計画中に計算値または選択した値を返す必要がある場合は、戻りパラメータを使用できます。ワークフローのプレビューまたはワークフローの実行が完了した後に、モニタリングウィンドウの [ 戻りパラメータ ] タブで計算値または選択した値を表示できます。

+
Aggregate ：戻りパラメータとしてアグリゲートを指定すると、リソース選択ロジックで選択されたアグリゲートを確認できます。

+
ワークフローに子ワークフローが含まれていて、子ワークフローの戻りパラメータ名にスペース、ドル記号（ $ ）が含まれている場合、 または、親ワークフローで子ワークフローの戻りパラメータ値を表示するには、親ワークフローの角かっこ内に戻りパラメータ名を指定する必要があります。

+
[cols="2*"]
|===
| パラメータ名 | 指定する形式 


 a| 
'ChildWorkflow1.abc$values
 a| 
「 ChildWorkflow1 [ "abc$"+" 値 "]`



 a| 
'ChildWorkflow1.$values
 a| 
「 ChildWorkflow1 ["$"+" 値 "]`



 a| 
「 ChildWorkflow1.value $`
 a| 
「 ChildWorkflow1.value $`



 a| 
'ChildWorkflow1.P N
 a| 
「 ChildWorkflow1 [ "P N"] 」



 a| 
'ChildWorkflow1.return_string("HW")`
 a| 
'ChildWorkflow1[ "return_string(\"HW\" )"]`

|===
. * オプション： * ヘルプコンテンツ * タブをクリックして、ワークフロー用に作成したヘルプコンテンツファイルを追加します。
. [* プレビュー ] をクリックして、ワークフローの計画が正常に完了していることを確認します。
. [OK] をクリックしてプレビューウィンドウを閉じます。
. [ 保存（ Save ） ] をクリックします。




== 完了後

テスト環境でワークフローをテストしてから、ワークフローを「 * _ ワークフロー名 _ * > * _ 詳細 _ * 」で本番環境向けの準備完了としてマークします。
